// 회원 등록 테이블
CREATE TABLE JEJU_MEMBER(
    MEMBER_ID VARCHAR2(50) CONSTRAINT PK_MEMBER PRIMARY KEY
    , MEMBER_PW VARCHAR2(50) NOT NULL
    , MEMBER_NAME VARCHAR2(50) NOT NULL
    , MEMBER_TEL VARCHAR2(30) UNIQUE -- 010-1111-2222
    , GENDER VARCHAR2(5) ---- '남','여'
    , BIRTH_DATE VARCHAR2(20)
    , MEMBER_MAIL VARCHAR(30) NOT NULL
    , MEMBER_ROLL VARCHAR2(7) DEFAULT 'USER' -- USER, ADMIN, MANAGER
);

-- 회원등록 (관리자)
INSERT INTO JEJU_MEMBER(
    MEMBER_ID
    , MEMBER_PW
    , MEMBER_NAME
    , MEMBER_TEL
    , GENDER
    , BIRTH_DATE
    , MEMBER_MAIL
)VALUES(
    'admin'
    , '1111'
    , '관리자'
    , '010-1111-1111'
    , '남'
    , '1996-01-01'
    , 'admin@naver.com'
);

// admin에 관리자 권한 부여
UPDATE JEJU_MEMBER
SET MEMBER_ROLL = 'ADMIN'
WHERE MEMBER_ID = 'admin';


SELECT * FROM JEJU_MEMBER;

/////////////////////// 공지사항 카테고리 테이블
CREATE TABLE ANN_CATE_LIST (
    CATE_CODE VARCHAR2(30) CONSTRAINT PK_CATE_CODE PRIMARY KEY
    , CATE_NAME VARCHAR2(30) NOT NULL
);

INSERT INTO ANN_CATE_LIST VALUES ('CATE_001', '일반');
INSERT INTO ANN_CATE_LIST VALUES ('CATE_002', '오픈소식');
INSERT INTO ANN_CATE_LIST VALUES ('CATE_003', '서비스');
INSERT INTO ANN_CATE_LIST VALUES ('CATE_004', '당첨자발표');
INSERT INTO ANN_CATE_LIST VALUES ('CATE_005', '이벤트');

SELECT * FROM ANN_CATE_LIST;

// 공지사항 테이블
CREATE TABLE ANNOUNCEMENT(
    ANN_NUM VARCHAR2(30) CONSTRAINT PK_ANN PRIMARY KEY
    , ANN_CATE VARCHAR2(50) CONSTRAINT FK_CATE_CODE
    REFERENCES ANN_CATE_LIST (CATE_CODE)
    , ANN_WRITER VARCHAR2(50) CONSTRAINT FK_ANN_MEMBER_ID
    REFERENCES JEJU_MEMBER (MEMBER_ID)
    , ANN_TITLE VARCHAR2(100) NOT NULL
    , ANN_CONTENT VARCHAR2(4000) NOT NULL  --썸머노트
    , ANN_DATE DATE DEFAULT SYSDATE
);

INSERT INTO ANNOUNCEMENT (
    ANN_NUM
    , ANN_CATE
    , ANN_WRITER
    , ANN_TITLE
    , ANN_CONTENT
    )
VALUES(
    (SELECT 'ANN_' ||LPAD(NVL(MAX(TO_NUMBER(SUBSTR(ANN_NUM, 5))),0) + 1, 3, '0')
    FROM ANNOUNCEMENT)
    , 'CATE_005'
    , 'admin'
    , '제목'
    , '내용'
);

SELECT * FROM ANNOUNCEMENT
ORDER BY ANN_NUM;

///////////////////////////  QNA 카테고리 테이블

CREATE TABLE QNA_CATE_LIST (
    CATE_CODE VARCHAR2(50) CONSTRAINT PK_QNA_CODE_LIST PRIMARY KEY
    , CATE_NAME VARCHAR2(50) NOT NULL
);

INSERT INTO QNA_CATE_LIST VALUES('CATE_001', '숙박');
INSERT INTO QNA_CATE_LIST VALUES('CATE_002', '결제');
INSERT INTO QNA_CATE_LIST VALUES('CATE_003', '혜택');
INSERT INTO QNA_CATE_LIST VALUES('CATE_004', '기타');
INSERT INTO QNA_CATE_LIST VALUES('CATE_005', '이벤트');


SELECT * FROM QNA_CATE_LIST;

////////////////// QNA 카테고리 테이블

CREATE TABLE QNA (
    QNA_CODE VARCHAR2(50) CONSTRAINT PK_QNA PRIMARY KEY
    , CATE_CODE VARCHAR2(50) CONSTRAINT FK_QNA_CODE
    REFERENCES QNA_CATE_LIST (CATE_CODE)
    , QNA_QUESTION VARCHAR2(100) NOT NULL
    , QNA_ANSWER VARCHAR2(4000) NOT NULL
);

INSERT INTO QNA
VALUES (
    (SELECT 'QNA_' ||LPAD(NVL(MAX(TO_NUMBER(SUBSTR(QNA_CODE, 5))),0) + 1, 3, '0')FROM QNA)
    , 'CATE_001'
    , '제목'
    , '내용'
);

SELECT * FROM QNA;

/////////////// 문의하기 카테고리 테이블

CREATE TABLE INQ_CATE_LIST (
    CATE_CODE VARCHAR2(50) CONSTRAINT INQ_CATE PRIMARY KEY
    , CATE_NAME VARCHAR2(50)
);

INSERT INTO INQ_CATE_LIST VALUES ('CATE_001', '숙박');
INSERT INTO INQ_CATE_LIST VALUES ('CATE_002', '결제');
INSERT INTO INQ_CATE_LIST VALUES ('CATE_003', '혜택');
INSERT INTO INQ_CATE_LIST VALUES ('CATE_004', '기타');
INSERT INTO INQ_CATE_LIST VALUES ('CATE_005', '이벤트');


////////////////// 문의하기 테이블

CREATE TABLE INQUIRE (
    INQ_CODE VARCHAR2(50) CONSTRAINT PK_INQ PRIMARY KEY
    , CATE_CODE VARCHAR2(50) CONSTRAINT FK_INQ_CATE
    REFERENCES INQ_CATE_LIST (CATE_CODE)
    , MEMBER_ID VARCHAR2(50) CONSTRAINT FK_INQ_ID
    REFERENCES JEJU_MEMBER (MEMBER_ID)
    , TITLE VARCHAR2(50) NOT NULL
    , CONTENT VARCHAR2(4000) NOT NULL
    , INQ_DATE DATE DEFAULT SYSDATE
    , IS_RESPONSE VARCHAR2(50) DEFAULT 'N'
);

INSERT INTO INQUIRE (
    INQ_CODE
    , CATE_CODE
    , MEMBER_ID
    , TITLE
    , CONTENT
)
VALUES (
    (SELECT 'INQ_' ||LPAD(NVL(MAX(TO_NUMBER(SUBSTR(INQ_CODE, 5))),0) + 1, 3, '0')FROM INQUIRE)
    , 'CATE_004'
    , 'admin'
    , '제목'
    , '내용'
);

SELECT * FROM INQUIRE;

--  문의하기 사진 테이블

CREATE TABLE INQ_IMG (
    IMG_CODE VARCHAR2(50) CONSTRAINT PK_ING_IMG PRIMARY KEY
    , ORIGIN_FILE_NAME VARCHAR2(100) NOT NULL
    , ATTACHED_FILE_NAME VARCHAR2(100) NOT NULL
    , INQ_CODE VARCHAR2(50) CONSTRAINT FK_INQ_CODE
    REFERENCES INQUIRE (INQ_CODE)
);

DELETE INQUIRE;

SELECT * FROM INQ_IMG;


CREATE TABLE INQ_RESPONSE (
    RES_CODE VARCHAR2(50) CONSTRAINT PK_INQ_RESPONSE PRIMARY KEY -- 답변 넘버
    , INQ_CODE VARCHAR2(50) CONSTRAINT FK_RES_INQ_CODE  -- 문의 내용 코드 (외래키)
    REFERENCES INQUIRE (INQ_CODE)
    , INQ_RESPONSE VARCHAR2(4000)  -- 답변 내용
    , RES_DATE DATE DEFAULT SYSDATE -- 답변 날짜
);


INSERT INTO INQ_RESPONSE (
    RES_CODE
    , INQ_CODE
    , INQ_RESPONSE
) VALUES (
    (SELECT 'RES_' ||LPAD(NVL(MAX(TO_NUMBER(SUBSTR(RES_CODE, 5))),0) + 1, 3, '0')FROM INQ_RESPONSE)
    , 'INQ_001'
    , '문의내역 답변입니다.'
);

SELECT * FROM INQ_RESPONSE;


CREATE TABLE RES_IMG (
    IMG_CODE VARCHAR2(50) CONSTRAINT PK_RES_IMG PRIMARY KEY
    , ORIGIN_FILE_NAME VARCHAR2(100) NOT NULL
    , ATTACHED_FILE_NAME VARCHAR2(100) NOT NULL
    , RES_CODE VARCHAR2(50) CONSTRAINT FK_RES_CODE
    REFERENCES INQ_RESPONSE (RES_CODE)
);

SELECT * FROM RES_IMG;