<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{fragment/main_layout}">

<head>
    <meta charset="UTF-8">
    <title></title>
    <th:block layout:fragment="content_css">
        <style>
            .w_in {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .main {
                width: 70%;
                margin-right: 30px;
            }

            .m1_title {
                color: #1db954;
                font-size: 22px;
                font-weight: 700;
                padding-bottom: 15px;
            }

            .tbl table {
                width: 100%;
                border-bottom: 1px solid #ddd;
                border-collapse: separate;
                table-layout: fixed;
                font-size: 15px;
            }

            .tbl table.board_type th,
            .tbl table.board_type td {
                padding: 15px;
                text-align: center;
                border-top: 1px solid #ddd;
                color: black;

            }

            .tbl th {
                background-color: #03c75a;
                font-size: 15px;
                font-weight: 600;
                color: #111;
            }

            .tbl th,
            .tbl td {
                text-align: left;
                min-height: 54px;
                padding: 15px 20px;
                font-weight: 400;
                line-height: 23px;
            }

            .re_btn {
                background-color: #03c75a;
                color: white;
                padding: 12px 20px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
            }

            .re_btn:hover {
                background-color: #03c75a;
            }

            .starbo2 {
                display: inline-block;
                background-image: url(/img/emptystarwhite.png);
                background-size: contain;
                width: 100%;
                height: 100%;
            }
        </style>
    </th:block>
</head>
    
<body>

    <th:block layout:fragment="content">
        <div>
            <div class="w_in">
                <div class="main">
                    <h3 class="m1_title">예약내역</h3>
                    <div class="tbl">
                        <table class="board_type">
                            <colgroup>
                                <col width="20%" style=" border-radius: 0 0 0 50%;">
                                <col width="10%">
                                <col width="20%">
                                <col width="10%">
                                <col width="30%">
                                <col width="10%">
                            </colgroup>
                            <thead>
                                <th style="border-radius: 15px 0 0 0;">평점</th>
                                <th>작성자</th>
                                <th>작성일자</th>
                                <th>숙박업소명</th>
                                <th>내용</th>
                                <th style="border-radius: 0 15px 0 0;">답변</th>
                            </thead>
                            <tbody>
                                <tr th:if="${myReviewList == null}">
                                    <td colspan="6">
                                        <div class="data_no">
                                            <div class="cont">
                                                <strong>"현재 예약 내역이 존재하지 않습니다."</strong><br>
                                                "즐거운 여행 계획을 준비해 보세요!"
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr th:each="review , state : ${myReviewList}">
                                    <td>
                                        <div class="star" th:data-set-score="${review.score}"
                                            style="width: 100px; margin: 0 auto; height: 20px;">
                                            <div class="starbo2">
                                            </div>
                                        </div>
                                    </td>
                                    <td>[[${review.memberId}]]</td>
                                    <td>[[${review.writeDate}]]</td>
                                    <td>[[${review.sampleACCVO.accomName}]]</td>
                                    <td>[[${review.content}]]</td>
                                    <td th:if="${review.reviewAdminVO.memberId == null}">X</td>
                                    <td th:if="${review.reviewAdminVO.memberId != null}">
                                        <input type="button" value="답변보기" onclick="openPopup(this)"
                                            th:data-reply-id="${review.reviewAdminVO.memberId}"
                                            th:data-reply-content="${review.reviewAdminVO.content}"
                                            th:data-reply-date="${review.reviewAdminVO.writeDate}">

                                    </td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>


    </th:block>
</body>

<th:block layout:fragment="content_js">
    <script>
        let myWindow = null;
        scorestar();
        function scorestar() {
            document.querySelectorAll('.star').forEach(element => {
                let yellow = element.dataset.setScore * 10
                console.log(yellow)
                element.style.backgroundImage = `linear-gradient(to right, yellow ${yellow}%, transparent ${yellow}%)`
            });
        }
        function openPopup(tag) {
            if (myWindow != null) {
                myWindow.close();
            }
            myWindow = window.open("", "myWindow", "width=200,height=100,top=440,left=780");
            myWindow.document.write(`
                <div>
                    작성자 : ${tag.dataset.replyId} 작성일자 : ${tag.dataset.replyDate}
                </div>
                <textarea name="" id="" cols="100" rows="100" style="
                resize: none;">${tag.dataset.replyContent}</textarea>
    `);
        }
    </script>
</th:block>

</html>